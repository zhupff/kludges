apply plugin: "kotlin"
apply plugin: "kotlin-kapt"

dependencies {
    compileOnly gradleApi()
    compileOnly BUILD_GRADLE
    implementation AUTO_SERVICE_ANNOTATION
    kapt AUTO_SERVICE
}

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8

apply from: rootProject.file("gradle/scripts/publish.gradle")

/**
 * 同步gradle.properties中的常数到生成的Constant.kt中。
 */
task createConstant() {
    StringBuilder sb = new StringBuilder()
        .append("/** Do Not Modify! This File Is Generated Automatically! **/\r\n")
        .append("package kludge.api\r\n")
        .append("const val GROUP = \"${GROUP}\"\r\n")
        .append("const val VERSION = \"${VERSION}\"\r\n")
        .append("const val AUTO_SERVICE_ANNOTATION = \"${AUTO_SERVICE_ANNOTATION}\"\r\n")
        .append("const val AUTO_SERVICE = \"${AUTO_SERVICE}\"\r\n")
    new File("${projectDir.path}/src/main/kotlin/kludge/api/Constant.kt").text = sb.toString()
}